<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Aureos ACC Project Creation Form</title>
    <link rel="stylesheet" href="assets/css/main.css">
    <script src="js/variables.js"></script>
    <script src="js/main.js"></script>
    <script src="js/login.js"></script>
    <script src="js/default.js"></script>
    <link rel="icon" href="https://www.aureos.com/wp-content/uploads/2025/02/AUREOS-FAVicon_512px-x-512px-150x150.png"
        sizes="32x32">
</head>

<body>
    <div class="top-bar">
        <div class="menuLogoContainer">
            <div class="menu-container">
                <!-- Burger Icon -->
                <div class="burger-icon">
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
                <!-- Side Menu -->
                <div class="side-menu" id="side-menu">

                </div>
            </div>
            <img src="https://www.aureos.com/wp-content/themes/keltbray/assets/img/logo/AUREOS_logo_wh.svg"
                class="logo logo--white" alt="Aureos Logo">
        </div>
        <div class="title">
            <h2>ACC Project Creation Form</h2>
        </div>
        <div class="profile-container" id="profileMenu">
            <img id="userPic" src="https://images.profile.autodesk.com/default/user_X58.png" alt="Profile"
                class="profile-pic" />
            <div class="dropdown-menu" id="dropdown">
                <div><strong>User:</strong>
                    <p id="userName"></p>
                </div>
                <div><strong>Email:</strong>
                    <p id="userEmail"></p>
                </div>
                <div class="logout" onclick="logout()">Logout</div>
            </div>
        </div>
    </div>
    <div class="wrap">



        <form id="intakeForm" novalidate>
            <header>
                <p class="lead">Fill out the project details below. Required fields are marked with <span class="required">*</span>.</p>
            </header>
            <fieldset>
                <legend>Main Details</legend>
                <div class="chips-field" data-type="email" data-name="requestorEmail">
                    <label>Requestor Email <span class="required">*</span></label>
                    <div class="chips-wrap" role="list">
                        <span class="sr-only">Requestor email address</span>
                        <div class="chips-input">
                            <input type="text" inputmode="email" autocomplete="off"
                                placeholder="Add Requestor email and press Enter, comma, or space"
                                aria-describedby="pmHelp pmError" />
                        </div>
                    </div>
                    <div id="pmError" class="error" aria-live="polite"></div>
                    <input type="hidden" name="requestorEmail" value="" />
                </div>
                <div class="grid">
                    <div class="col-8">
                        <label for="projectName">Project Name <span class="required">*</span></label>
                        <input id="projectName" name="projectName" type="text" required
                            placeholder="e.g., A45 Junction Upgrade" />
                    </div>
                    <div class="col-4">
                        <label for="projectId">Project Ref / ID</label>
                        <input id="projectId" name="projectId" type="text" placeholder="e.g., AU0001" />
                    </div>

                    <div class="col-4">
                        <label for="client">Client / Customer</label>
                        <input id="client" name="client" type="text" placeholder="e.g., National Highways" />
                    </div>
                    <div class="col-4">
                        <label for="client">Client / Customer Number</label>
                        <input id="clientNo" name="clientNo" type="text" placeholder="e.g., CL000012" />
                    </div>
                    <div class="col-4">
                        <label for="location">Postcode</label>
                        <input id="location" name="location" type="text" placeholder="Postcode" />
                    </div>

                    <div class="col-6">
                        <label for="unit">Unit <span class="required">*</span></label>
                        <select id="unit" name="unit" required>
                            <option value="" disabled selected>Select unit…</option>
                            <option>Highways</option>
                            <option>Rail</option>
                            <option>Renewables</option>
                            <option>D&amp;T</option>
                            <option>IDEC</option>
                            <option>SP&amp;C</option>
                            <option>ATS</option>
                            <option>Electricityworx</option>
                        </select>
                    </div>
                    <div class="col-6">
                        <label for="stage">Contract Stage <span class="required">*</span></label>
                        <select id="stage" name="stage" required>
                            <option value="" disabled selected>Select stage…</option>
                            <option>Pre-con</option>
                            <option>Contract Awarded</option>
                        </select>
                    </div>

                    <div class="col-6">
                        <label for="startDate">Start Date</label>
                        <input id="startDate" name="startDate" type="date" />
                    </div>
                    <div class="col-6">
                        <label for="endDate">End Date</label>
                        <input id="endDate" name="endDate" type="date" />
                    </div>
                    
                </div>
            </fieldset>
            <fieldset>
                <legend>Project Setup</legend>
                    <div class="col-12">
                        <label for="value">Project Type <span class="required">*</span></label>
                        <p class="subline">Single is one project folder structure, framework is multiple project folder structures in an ACC project</p>
                        <select id="type" name="type" required>
                            <option value="" disabled selected>Select project type…</option>
                            <option>Single</option>
                            <option>Framework</option>
                        </select>
                        <div class="error"></div>
                    </div>
                        <div class="chips-field hidden" data-type="tags" data-name="regions" id="framework_regions_section">
                            <label class="chips-label">If your framework has Regions / Groups please specify below</label>
                            <div class="chips-wrap" role="list">
                                <span class="sr-only">Regions or groups</span>
                                <div class="chips-input">
                                <input type="text" autocomplete="off" placeholder="Type a region/group and press Enter, comma, or semicolon" aria-describedby="regionsHelp regionsError" />
                                </div>
                            </div>
                            <div id="regionsHelp" class="hint">Examples: <em>North West</em>, <em>Scotland</em>, <em>JV Group A</em>. Spaces are allowed. Paste lists separated by commas, semicolons, or new lines.</div>
                            <div id="regionsError" class="error" aria-live="polite"></div>
                            <input type="hidden" name="regions" value="" />
                        </div>
            </fieldset>
            <fieldset>
                <legend>Key Roles</legend>

                <!-- Reusable multi-email field: Project Managers -->
                <div class="chips-field" data-type="email" data-name="projectManagers">
                    <label class="chips-label">Project Managers <span class="required">*</span></label>
                    <div class="chips-wrap" role="list">
                        <span class="sr-only">Project Manager email addresses</span>
                        <div class="chips-input">
                            <input type="text" inputmode="email" autocomplete="off"
                                placeholder="Add PM emails and press Enter, comma, or space"
                                aria-describedby="pmHelp pmError" />
                        </div>
                    </div>
                    <div id="pmHelp" class="hint">Tip: Paste multiple emails separated by comma, semicolon, space or new
                        lines.</div>
                    <div id="pmError" class="error" aria-live="polite"></div>
                    <input type="hidden" name="projectManagers" value="" />
                </div>

                <!-- Reusable multi-email field: Document Controllers -->
                <div class="chips-field" data-type="email" data-name="documentControllers">
                    <label class="chips-label">Document Controllers <span class="required">*</span></label>
                    <div class="chips-wrap" role="list">
                        <span class="sr-only">Document Controller email addresses</span>
                        <div class="chips-input">
                            <input type="text" inputmode="email" autocomplete="off"
                                placeholder="Add DC emails and press Enter, comma, or space"
                                aria-describedby="dcHelp dcError" />
                        </div>
                    </div>
                    <div id="dcHelp" class="hint">Tip: Paste multiple emails separated by comma, semicolon, space or new
                        lines.</div>
                    <div id="dcError" class="error" aria-live="polite"></div>
                    <input type="hidden" name="documentControllers" value="" />
                </div>

                <!-- Reusable multi-email field: Access Approvers -->
                <div class="chips-field" data-type="email" data-name="accessApprovers">
                    <label class="chips-label">Access Approvers <span class="required">*</span></label>
                    <div class="chips-wrap" role="list">
                        <span class="sr-only">Access Approver email addresses</span>
                        <div class="chips-input">
                            <input type="text" inputmode="email" autocomplete="off"
                                placeholder="Add approver emails and press Enter, comma, or space"
                                aria-describedby="aaHelp aaError" />
                        </div>
                    </div>
                    <div id="aaHelp" class="hint">Tip: Paste multiple emails separated by comma, semicolon, space or new
                        lines.</div>
                    <div id="aaError" class="error" aria-live="polite"></div>
                    <input type="hidden" name="accessApprovers" value="" />
                </div>

            </fieldset>
            <fieldset>
                <legend>Project Team</legend>
                    <div class="gallery" id="emailGallery">
                    <label>Initial Project Members List</label>
                    <!-- Email rows go here -->
                    </div>
                    <!-- Hidden file input -->
                    <input type="file" id="csvUpload" accept=".csv" style="display: none;" />

                    <!-- Custom-styled trigger button -->
                    <button type="button" class="custom-btn hidden" onclick="generateExcel()">Generate Excel</button>
                    <button type="button" id="uploadBtn" class="custom-btn hidden">📄 Import Emails from CSV</button>
                    
                    <button type="button" id="addRowBtn">+ Add Email Row</button>
            </fieldset>
            <div class="actions">
                <button type="reset" id="resetBtn">Reset</button>
                <button type="submit" class="primary">Submit</button>
            </div>

            <details style="margin-top:16px">
                <summary>Show submission payload (for testing)</summary>
                <pre id="output" aria-live="polite"></pre>
            </details>
        </form>
    </div>
      <div id="popup" class="popup"></div>
  <div id="loading" class="loading-spinner">
    Loading...
  </div>
<div id="appInfo"></div>
</body>

</html>